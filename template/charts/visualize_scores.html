{% load static %}
{% block top %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualization Page</title>

    <!-- Load external scripts -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load static assets -->
    <link rel="stylesheet" href="{% static 'assets/vendors/mdi/css/materialdesignicons.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendors/css/vendor.bundle.base.css' %}">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <!-- endinject -->
  <!-- Layout styles -->
  <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
  <!-- End layout styles -->
  <link rel="shortcut icon" href="{% static 'assets/images/favicon.ico' %}" />

    <!-- Custom styles -->
    <style>
        .visualization-data {
            padding: 20px;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .graph-container {
            width: 45%;
            float: left;
            margin-right: 5%; /* Optional: Add some margin between the graph containers */
        }

        @media (max-width: 768px) {
            .graph-container {
                width: 100%; /* Adjust for smaller screens (e.g., mobile devices) */
                float: none;
                margin-right: 0;
            }
        }
        #signout:hover {
            color: blueviolet;
        }
        
    </style>
</head>
{% endblock %}
<body>

    <!-- Navbar -->
    {% include 'PurpleTemplate/partials/_navbar.html' %}




    <!-- Main content wrapper -->
    <div class="container-fluid page-body-wrapper">

        <!-- Sidebar -->
        {% include 'PurpleTemplate/partials/_sidebar.html' %}
        
        <div class="main-panel">
            <div class="content-wrapper">
        <!-- Page header -->
        <div class="page-header">
            <h3 class="page-title">
              <span class="page-title-icon bg-gradient-primary text-white me-2">
                <i class="mdi mdi-map menu-icon"></i>
              </span> Visualize
            </h3>
            <!-- Breadcrumbs -->
            <nav aria-label="breadcrumb">
              <ul class="breadcrumb">
                <li class="breadcrumb-item active" aria-current="page">
                  <span></span>Overview <i class="mdi mdi-alert-circle-outline icon-sm text-primary align-middle"></i>
                </li>
              </ul>
            </nav>
          </div>

                <!-- Visualization section -->
                <section>
                    <!-- Year and Course selection form -->
                    <div class="row mt-3">
                        <form action="{% url 'visualization' %}" method="get">
                            <label for="passout_year_select">Select Passout Year:</label>
                            <select id="passout_year_select" name="passout_year_select">
                                {% for passout_year in passout_years %}
                                    <option value="{{ passout_year.id }}" {% if passout_year.id == selected_passout_year %}selected{% endif %}>{{ passout_year.year }}</option>
                                {% endfor %}
                            </select>
                        
                            <label for="course_select">Select Course:</label>
                            <select id="course_select" name="course_select">
                                <option value="">------</option>
                                {% for course_id, course_code in courses %}
                                    <option value="{{ course_id }}" {% if course_id == selected_course_id %}selected{% endif %}>{{ course_code }}</option>
                                {% endfor %}
                            </select>
                            <button type="submit">View Data</button>
                        </form>
                    </div>
                    
                    <!-- Display visualization data -->
                    <div class="row mt-3">
                        {% if selected_passout_year %}
                            <div class="visualization-data">
                                <p>Passout Year: {{ year }}</p>
                                <p>Course: {{ selected_course_name }}</p>
                                <div class="graph-container" style="width: 45%; float: left;">
                                    <h2>Percentage of Attainment for {{ year }}</h2>
                                    <h4>Percentage of Attainment: {{ attainment_percentage }}%</h4>
                                    <div id="individual_graph">{{ individual_graph_html | safe }}</div>
                                </div>
                                <div class="graph-container" style="width: 45%; float: right;">
                                    <h2>Trend Graph for {{ year }}</h2>
                                    <div id="trend_graph">{{ trend_graph_html | safe }}</div>
                                </div>
                                <div style="clear: both;"></div> <!-- Clear float to ensure proper layout -->
                            </div>
                        {% else %}
                            <p>Please select a passout year and course to visualize data.</p>
                        {% endif %}
                    </div>
                </section>
                
            </div>
        </div>
    </div>

    <script src="{% static 'assets/vendors/js/vendor.bundle.base.js' %}"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="{% static 'assets/vendors/chart.js/Chart.min.js' %}"></script>
  <script src="{% static 'assets/js/jquery.cookie.js' %}" type="text/javascript"></script>
  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="{% static 'assets/js/off-canvas.js' %}"></script>
  <script src="{% static 'assets/js/hoverable-collapse.js' %}"></script>
  <script src="{% static 'assets/js/misc.js' %}"></script>
  <!-- endinject -->
  <!-- Custom js for this page -->
  <script src="{% static 'assets/js/dashboard.js' %}"></script>
  <script src="{% static 'assets/js/todolist.js' %}"></script>
  <!-- End custom js for this page -->
</body>

</html>
